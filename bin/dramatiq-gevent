#!python
try:
    from gevent import monkey; monkey.patch_all()  # noqa
except ImportError:
    import sys
    sys.stderr.write("error: gevent is missing. Run `pip install gevent`.")
    sys.exit(1)

import sys
import os
from dramatiq.cli import make_argument_parser, main

if __name__ == "__main__":
    # Extend the default arguments with our gevent specific worker class
    parser = make_argument_parser()
    parser.set_defaults(worker_class="dramatiq.gevent_worker.GeventWorker")
    
    # Pass the modified args to main
    args = parser.parse_args()
    sys.exit(main(args))
